<div class="container pt-4 pb-4">
    <app-create-module-manual (onSuccessfulSubmission)="ngOnInit()"></app-create-module-manual>

    <hr>

    <!-- dataview that lists all created manuals-->
    <p-dataView #dv [value]="moduleManuals" [paginator]="true" [rows]="5" [sortField]="sortField" [sortOrder]="sortOrder"
    [emptyMessage]="emptyMessage" filterBy="spo.course">

        <!--dataview-header-->
        <ng-template pTemplate="header">
          <div class="d-flex flex-row justify-content-between">
            <!-- search-input -->
            <span class="p-input-icon-left mb-2 md:mb-0">
              <i class="pi pi-search"></i>
              <input type="search" pInputText placeholder="Studienfach" id="input-search" (input)="dv.filter($event.target.value, 'contains')">
            </span>

            <!-- sort-dropdown -->
            <p-dropdown [options]="sortOptions" [(ngModel)]="sortKey" placeholder="Sortieren nach" id="dropdown-sort"
            (onChange)="onSortChange($event)" [style]="{'min-width':'15em'}"></p-dropdown>
          </div>
        </ng-template>

        <!-- module-manual-list-->
        <ng-template let-moduleManual let-i="rowIndex" pTemplate="listItem">
            <div class="block p-3">

                <!-- overlay-link for the list-element, spans whole ".inner"-block -->
                <a class="overlay" [routerLink]="['/manual-edit', moduleManual.id]" id="link-manual-{{i}}"></a>

                <div class="inner list-group-item d-flex justify-content-between align-items-start">
                    <div class="me-auto">

                        <!-- manual-title -->
                        <div class="fw-bold fs-5">{{moduleManual.spo.degree}} {{moduleManual.spo.course}}</div>

                        <!-- manual-timespan -->
                        <span *ngIf="moduleManual.spo.endDate === null; else endDate" class="fs-6 ms-4">
                            Gültig für Studienanfänger ab dem <i>{{getGermanDate(moduleManual.spo.startDate)}}</i>
                        </span>
                        <ng-template #endDate>
                            <span class="fs-6  ms-4">
                                Gültig für Studienanfänger im Zeitraum
                                <i>{{getGermanDate(moduleManual.spo.startDate)}} - {{getGermanDate(moduleManual.spo.endDate)}}</i>
                            </span>
                        </ng-template>

                        <!-- spo-link-->
                        <a href="{{moduleManual.spo.link}}" class="ms-4 link-secondary d-block" id="link-spo-{{i}}">
                            <i class="bi bi-link-45deg"></i><small>zur Studien- und Prüfungsordnung</small>
                        </a>
                    </div>

                    <!-- semester-->
                    <span class="badge bg-success rounded-pill">{{moduleManual.semester}}</span>
                </div>
            </div>
        </ng-template>
    </p-dataView>
</div>

